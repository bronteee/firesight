<!DOCTYPE html><html><head><head> <!-- Include Meta Tags Here --><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta http-equiv="X-UA-Compatible" content="ie=edge"><meta name="viewport" content="width=device-width, height=device-height, initial-scale=1 user-scalable=no, shrink-to-fit=no"><meta content='#000000' name='theme-color'/><meta name="keywords" content=""><title>FireSight - AI Insight on Wildfire Impact | Week 4 | Metrics and Loss Functions</title><!-- Open Graph general (Facebook, Pinterest & Google+) --><meta name="og:title" content="FireSight - AI Insight on Wildfire Impact | Week 4 | Metrics and Loss Functions"><meta name="og:description" content="This week, we will dig further into the losses and metrics used by the original next day wild fire paper and train our model using the same losses and metrics on the dataset."><meta name="og:image" content="/images/week4_metric.jpeg"><meta name="og:image:alt" content="FireSight - AI Insight on Wildfire Impact | Week 4 | Metrics and Loss Functions"><meta name="og:url" content="http://localhost:4000/week4/"><meta name="article:author" content="https://www.facebook.com/"><meta name="og:site_name" content="FireSight - AI Insight on Wildfire Impact | Week 4 | Metrics and Loss Functions"><meta name="og:type" content="website"> <!-- Twitter --><meta property="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="FireSight - AI Insight on Wildfire Impact | Week 4 | Metrics and Loss Functions"><meta name="twitter:description" content="This week, we will dig further into the losses and metrics used by the original next day wild fire paper and train our model using the same losses and metrics on the dataset."><meta name="twitter:site" content="@"><meta name="twitter:creator" content="@"><meta name="twitter:image:src" content="/images/week4_metric.jpeg"> <!-- Search Engine --><meta name="description" content="This week, we will dig further into the losses and metrics used by the original next day wild fire paper and train our model using the same losses and metrics on the dataset."><meta name="image" content="/images/week4_metric.jpeg"> <!-- Schema.org for Google --><meta itemprop="name" content="FireSight - AI Insight on Wildfire Impact | Week 4 | Metrics and Loss Functions"><meta name="author" content="Bronte Sihan Li"/><meta itemprop="description" content="This week, we will dig further into the losses and metrics used by the original next day wild fire paper and train our model using the same losses and metrics on the dataset."><meta itemprop="image" content="/images/week4_metric.jpeg"> <!-- Global site tag (gtag.js) - Google Analytics --> <script async src="https://www.googletagmanager.com/gtag/js?id="></script> <script> window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', ''); </script><title>FireSight - AI Insight on Wildfire Impact</title><link rel="stylesheet" href="/assets/css/style.css"> <script src="https://kit.fontawesome.com/6a97161b76.js" crossorigin="anonymous"></script><link rel="shortcut icon" href="http://localhost:4000/assets/images/logo.png" type="image/x-icon"></head></head><body><nav class="navbar is-black is-fixed-top" role="navigation" aria-label="main navigation" id="navbar"><div class="container"> <!-- logo or branding image on left side --><div class="navbar-brand"> <a class="navbar-item" href="http://localhost:4000/"> <strong>FireSight - AI Insight on Wildfire Impact</strong> </a><div class="navbar-burger" data-target="navbar-menu"> <span></span> <span></span> <span></span></div></div><!-- children of navbar-menu must be navbar-start and/or navbar-end --><div class="navbar-menu has-background-black" id="navbar-menu"> <!-- navbar items | left side --> <!--<div class="navbar-start"></div>--> <!-- navbar items | right side --><div class="navbar-end"> <a class="navbar-item " href="http://localhost:4000/">HOME</a> <a class="navbar-item " href="http://localhost:4000/#project">PROJECT</a> <a class="navbar-item" href="http://localhost:4000/#about">ABOUT</a> <a class="navbar-item" href="http://localhost:4000/#contact">CONTACT</a> <a class="navbar-item " href="http://localhost:4000/blog">BLOG</a><div class="navbar-item has-dropdown is-hoverable"> <a class="navbar-link"> MORE </a><div class="navbar-dropdown has-background-black is-left"> <a href="http://localhost:4000/asufm/" class="navbar-item has-text-grey-light "> Attention Swin U-net with Focal Modulation (ASUFM) </a> <a href="http://localhost:4000/introduction/" class="navbar-item has-text-grey-light "> Introduction </a> <a href="http://localhost:4000/wildfire-data/" class="navbar-item has-text-grey-light "> Wildfire Data </a> <a href="http://localhost:4000/wildfire-spread/" class="navbar-item has-text-grey-light "> Wildfire Spread Modeling </a> <!--<hr class="navbar-divider"> <a class="navbar-item"> Report an issue </a> --></div></div></div></div></div></nav><!-- Bulma Navbar JS --> <script> document.addEventListener('DOMContentLoaded', function () { /* Get all "navbar-burger" elements */ var $navbarBurgers = Array.prototype.slice.call(document.querySelectorAll('.navbar-burger'), 0); /* Check if there are any navbar burgers */ if ($navbarBurgers.length > 0) { /* Add a click event on each of them */ $navbarBurgers.forEach(function ($el) { $el.addEventListener('click', function () { /* Get the target from the "data-target" attribute */ var target = $el.dataset.target; var $target = document.getElementById(target); /* Toggle the class on both the "navbar-burger" and the "navbar-menu" */ $el.classList.toggle('is-active'); $target.classList.toggle('is-active'); }); }); } }); </script><section class="hero is-fullheight has-text-centered" id="post"><div class="hero-body"><div class="container"> <a href="/week4/" class="has-text-black" id="title"><h1 class="title has-text-centered is-2 has-text-weight-semibold ">Week 4 | Metrics and Loss Functions</h1></a><hr class="has-background-black"><div class="columns is-variable is-5"><div class="column is-6"><figure class="image is-16by9 has-shadow"> <img src="/images/week4_metric.jpeg" alt="" id="post-image"></figure></div><div class="subtitle column is-5 has-text-left-desktop has-text-left-fullhd has-text-left-tablet has-text-center-mobile"><p id="description" class="content is-small has-text-weight-medium is-uppercase">This week, we will dig further into the losses and metrics used by the original next day wild fire paper and train our model using the same losses and metrics on the dataset.</p><p class="subtitle is-6 is-uppercase has-text-weight-normal has-text-black-ter">Published on <b>October 02, 2023</b> by <a href="https://www.linkedin.com/in/brontesihanli/" target="_blank"><b class="has-text-link"><u>Bronte Sihan Li</u></b> </a></p><p class="subtitle is-uppercase"> <i class="fas fa-tags"></i> <span class="tag is-link">Wildfire</span> <span class="tag is-link">Deep Learning</span> <span class="tag is-link">machine learning</span> <span class="tag is-link">AI</span></p><p class="subtitle is-uppercase"><i class="fas fa-clock"></i> <b class="has-text-link"> 3 min </b>READ</p></div></div><div class="content has-text-justified-desktop has-text-justified-fullhd has-text-justified has-text-justified-tablet has-text-left-mobile"><p><p>With the results from last week, it was clear that we were not approaching the problem correctly. For example, through examining the fire mask prediction results from the trained UNet model, we discovered that by using a loss function that was a combination of binary cross entropy and dice loss, the model was not able to predict the fire masks correctly - in fact, the model was not predicting any positive fire pixels at all. This week, we will dig further into the losses and metrics used by the original next day wild fire paper and train our model using the same losses and metrics on the dataset.</p><h2 id="challenges-of-the-problem">Challenges of the Problem</h2><p>Looking at the problem of predicting next day wildfire again, it is clear that this is not a typical segmentation problem. The main challenge of this problem is that the fire pixels are very sparse in the image. In fact, the fire pixels only make up about 1% of the image. This means that the model will be trained on a dataset that is very imbalanced. This is a problem because the model will be trained to predict the majority class (non-fire pixels) and will not be able to predict the minority class (fire pixels) well.</p><h2 id="weighted-binary-cross-entropy">Weighted Binary Cross Entropy</h2><p>Cross entropy is a loss function that is used to measure the performance of a classification model whose output is a probability value between 0 and 1. The loss function is commonly used in machine learning and deep learning models, as the following:</p><p><img src="/images/cross_entropy.webp" alt="Cross Entropy" /></p><p>After applying an activation function of either sigmoid or softmax, for each class in the output, the cross entropy loss is calculated. The loss is then summed up for all classes and averaged over all samples. The loss function is then minimized by the model during training.</p><p>For our problem of predicting next day fire, we can think of using binary cross entropy to classify at each location on the map the probability of a fire. However, because we have a serious imbalance between the number of positive and negative samples, we need to weight the loss function to account for this imbalance. We can do this by assigning a weight to each class. The weight for the positive class is the inverse of the proportion of positive samples in the dataset, and the weight for the negative class is the inverse of the proportion of negative samples in the dataset. This way, the loss function will be weighted more towards the positive class, and the model will be trained to predict the positive class better. This means that for the next round of experiments, we will be using a weighted binary cross entropy as our only loss function to train our model.</p><h2 id="auc-precision-and-recall">AUC, Precision and Recall</h2><p>In addition to the weighted binary cross entropy loss function, we will also be using the AUC, precision and recall metrics to evaluate our model. The AUC metric is the area under the ROC curve, which is a plot of the true positive rate (TPR) against the false positive rate (FPR). The TPR is the proportion of positive samples that are correctly identified as positive, and the FPR is the proportion of negative samples that are incorrectly identified as positive.</p><p><img src="/images/metrics.jpg" alt="Metrics" /></p><p><img src="/images/roc_curve.svg" alt="ROC Curve" /></p><p><em>For more information on the ROC curve, see <a href="https://developers.google.com/machine-learning/crash-course/classification/roc-and-auc">here</a> and <a href="https://www.sciencedirect.com/science/article/pii/S016786550500303X#sec4">here</a>.</em></p><p>Photo by <a href="https://unsplash.com/@lazycreekimages?utm_content=creditCopyText&amp;utm_medium=referral&amp;utm_source=unsplash">Michael Dziedzic</a> on <a href="https://unsplash.com/photos/dSyhpTGhNHg?utm_content=creditCopyText&amp;utm_medium=referral&amp;utm_source=unsplash">Unsplash</a></p></p></div><div class="disqus-comments" id="disqus_thread"></div></div></div></section><footer id="footer"> <!--Footer Button--><div class="container has-text-centered has-background-grey-darker" id="backtotop"> <a class="has-text-white" onclick="window.scroll(0,0)">BACK TO TOP</a></div><!--Footer Main Section--><div class="has-background-grey-darker"><div class="container columns"> <!--Name Section--><div class="column has-text-left-desktop has-text-centered-mobile"> <a href="http://localhost:4000/#about"><div class="columns"><div class="column is-one-fifth-desktop is-one-fifth-fullhd is-one-quarter-tablet"><figure class="image is-64x64"> <img class="is-rounded" src="https://bronteee.github.io/images/headshot.JPG"></figure></div><div class="column is-marginless"><h5 class="has-text-grey-lighter">Bronte Sihan Li</h5><div class="content has-text-grey"><p>Bronte found her passion in artificial intelligence and research while w...</p></div></div></div></a></div><!--Link Section--><div class="column has-text-white"><h3>More Links</h3><li> <a href="http://localhost:4000/introduction/">Introduction</a></li><li> <a href="http://localhost:4000/wildfire-data/">Wildfire Data</a></li><li> <a href="http://localhost:4000/wildfire-spread/">Wildfire Spread Modeling</a></li></div><!--Blog-post Section--><div class="column has-text-white"><h3>Recent Posts</h3><li> <a href="http://localhost:4000/week8/">Week 8 | Exploring Different Deep Network Architectures</a></li><li> <a href="http://localhost:4000/week7/">Week 7 | What We Have Found So Far</a></li><li> <a href="http://localhost:4000/week6/">Week 6 | Exploring Different Ways to Improve</a></li></div></div></div><div class="has-background-black has-text-centered has-text-white" id="credits"> <i class="far fa-copyright"></i> 2024 | <a href="https://github.com/thedevslot/WhatATheme" target="_blank" rel="noopener noreferrer">WhatATheme</a> - A Theme made with <i class="fas fa-heart has-text-danger"></i> by <a href="https://www.twitter.com/thedevslot" target="_blank" rel="noopener noreferrer">TheDevsLot</a> Powered by <a href="https://jekyllrb.com/" target="_blank">Jekyll</a></div></footer></body><script> /** * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS. * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/ /* var disqus_config = function () { this.page.url = PAGE_URL; Replace PAGE_URL with your page's canonical URL variable this.page.identifier = PAGE_IDENTIFIER; Replace PAGE_IDENTIFIER with your page's unique identifier variable }; */ (function () { /* DON'T EDIT BELOW THIS LINE */ var d = document, s = d.createElement('script'); s.src = 'https://.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script></html>
