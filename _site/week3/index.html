<!DOCTYPE html><html><head><head> <!-- Include Meta Tags Here --><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta http-equiv="X-UA-Compatible" content="ie=edge"><meta name="viewport" content="width=device-width, height=device-height, initial-scale=1 user-scalable=no, shrink-to-fit=no"><meta content='#000000' name='theme-color'/><meta name="keywords" content=""><title>FireSight - AI Insight on Wildfire Impact | Week 3 | Unet and Baseline Results</title><!-- Open Graph general (Facebook, Pinterest & Google+) --><meta name="og:title" content="FireSight - AI Insight on Wildfire Impact | Week 3 | Unet and Baseline Results"><meta name="og:description" content="Now that we have our dataset ready, it is time to obtain some baseline results with the goal of 1/ evaluate the difficulty of the problem and 2/ determine if the problem is framed correctly. With that in mind, we will be using the Unet architecture as the starting architecture for this segmentation task."><meta name="og:image" content="/images/week3_net.jpeg"><meta name="og:image:alt" content="FireSight - AI Insight on Wildfire Impact | Week 3 | Unet and Baseline Results"><meta name="og:url" content="http://localhost:4000/week3/"><meta name="article:author" content="https://www.facebook.com/"><meta name="og:site_name" content="FireSight - AI Insight on Wildfire Impact | Week 3 | Unet and Baseline Results"><meta name="og:type" content="website"> <!-- Twitter --><meta property="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="FireSight - AI Insight on Wildfire Impact | Week 3 | Unet and Baseline Results"><meta name="twitter:description" content="Now that we have our dataset ready, it is time to obtain some baseline results with the goal of 1/ evaluate the difficulty of the problem and 2/ determine if the problem is framed correctly. With that in mind, we will be using the Unet architecture as the starting architecture for this segmentation task."><meta name="twitter:site" content="@"><meta name="twitter:creator" content="@"><meta name="twitter:image:src" content="/images/week3_net.jpeg"> <!-- Search Engine --><meta name="description" content="Now that we have our dataset ready, it is time to obtain some baseline results with the goal of 1/ evaluate the difficulty of the problem and 2/ determine if the problem is framed correctly. With that in mind, we will be using the Unet architecture as the starting architecture for this segmentation task."><meta name="image" content="/images/week3_net.jpeg"> <!-- Schema.org for Google --><meta itemprop="name" content="FireSight - AI Insight on Wildfire Impact | Week 3 | Unet and Baseline Results"><meta name="author" content="Bronte Sihan Li"/><meta itemprop="description" content="Now that we have our dataset ready, it is time to obtain some baseline results with the goal of 1/ evaluate the difficulty of the problem and 2/ determine if the problem is framed correctly. With that in mind, we will be using the Unet architecture as the starting architecture for this segmentation task."><meta itemprop="image" content="/images/week3_net.jpeg"> <!-- Global site tag (gtag.js) - Google Analytics --> <script async src="https://www.googletagmanager.com/gtag/js?id="></script> <script> window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', ''); </script><title>FireSight - AI Insight on Wildfire Impact</title><link rel="stylesheet" href="/assets/css/style.css"> <script src="https://kit.fontawesome.com/6a97161b76.js" crossorigin="anonymous"></script><link rel="shortcut icon" href="http://localhost:4000/assets/images/logo.png" type="image/x-icon"></head></head><body><nav class="navbar is-black is-fixed-top" role="navigation" aria-label="main navigation" id="navbar"><div class="container"> <!-- logo or branding image on left side --><div class="navbar-brand"> <a class="navbar-item" href="http://localhost:4000/"> <strong>FireSight - AI Insight on Wildfire Impact</strong> </a><div class="navbar-burger" data-target="navbar-menu"> <span></span> <span></span> <span></span></div></div><!-- children of navbar-menu must be navbar-start and/or navbar-end --><div class="navbar-menu has-background-black" id="navbar-menu"> <!-- navbar items | left side --> <!--<div class="navbar-start"></div>--> <!-- navbar items | right side --><div class="navbar-end"> <a class="navbar-item " href="http://localhost:4000/">HOME</a> <a class="navbar-item " href="http://localhost:4000/#project">PROJECT</a> <a class="navbar-item" href="http://localhost:4000/#about">ABOUT</a> <a class="navbar-item" href="http://localhost:4000/#contact">CONTACT</a> <a class="navbar-item " href="http://localhost:4000/blog">BLOG</a><div class="navbar-item has-dropdown is-hoverable"> <a class="navbar-link"> MORE </a><div class="navbar-dropdown has-background-black is-left"> <a href="http://localhost:4000/asufm/" class="navbar-item has-text-grey-light "> Attention Swin U-net with Focal Modulation (ASUFM) </a> <a href="http://localhost:4000/introduction/" class="navbar-item has-text-grey-light "> Introduction </a> <a href="http://localhost:4000/wildfire-data/" class="navbar-item has-text-grey-light "> Wildfire Data </a> <a href="http://localhost:4000/wildfire-spread/" class="navbar-item has-text-grey-light "> Wildfire Spread Modeling </a> <!--<hr class="navbar-divider"> <a class="navbar-item"> Report an issue </a> --></div></div></div></div></div></nav><!-- Bulma Navbar JS --> <script> document.addEventListener('DOMContentLoaded', function () { /* Get all "navbar-burger" elements */ var $navbarBurgers = Array.prototype.slice.call(document.querySelectorAll('.navbar-burger'), 0); /* Check if there are any navbar burgers */ if ($navbarBurgers.length > 0) { /* Add a click event on each of them */ $navbarBurgers.forEach(function ($el) { $el.addEventListener('click', function () { /* Get the target from the "data-target" attribute */ var target = $el.dataset.target; var $target = document.getElementById(target); /* Toggle the class on both the "navbar-burger" and the "navbar-menu" */ $el.classList.toggle('is-active'); $target.classList.toggle('is-active'); }); }); } }); </script><section class="hero is-fullheight has-text-centered" id="post"><div class="hero-body"><div class="container"> <a href="/week3/" class="has-text-black" id="title"><h1 class="title has-text-centered is-2 has-text-weight-semibold ">Week 3 | Unet and Baseline Results</h1></a><hr class="has-background-black"><div class="columns is-variable is-5"><div class="column is-6"><figure class="image is-16by9 has-shadow"> <img src="/images/week3_net.jpeg" alt="" id="post-image"></figure></div><div class="subtitle column is-5 has-text-left-desktop has-text-left-fullhd has-text-left-tablet has-text-center-mobile"><p id="description" class="content is-small has-text-weight-medium is-uppercase">Now that we have our dataset ready, it is time to obtain some baseline results with the goal of 1/ evaluate the difficulty of the problem and 2/ determine if the problem is framed correctly. With that in mind, we will be using the Unet architecture as the starting architecture for this segmentation task.</p><p class="subtitle is-6 is-uppercase has-text-weight-normal has-text-black-ter">Published on <b>September 25, 2023</b> by <a href="https://www.linkedin.com/in/brontesihanli/" target="_blank"><b class="has-text-link"><u>Bronte Sihan Li</u></b> </a></p><p class="subtitle is-uppercase"> <i class="fas fa-tags"></i> <span class="tag is-link">Wildfire</span> <span class="tag is-link">Unet</span> <span class="tag is-link">Deep Learning</span> <span class="tag is-link">machine learning</span> <span class="tag is-link">AI</span></p><p class="subtitle is-uppercase"><i class="fas fa-clock"></i> <b class="has-text-link"> 3 min </b>READ</p></div></div><div class="content has-text-justified-desktop has-text-justified-fullhd has-text-justified has-text-justified-tablet has-text-left-mobile"><p><p>Now that we have our dataset ready, it is time to obtain some baseline results with the goal of 1/ evaluate the difficulty of the problem and 2/ determine if the problem is framed correctly. With that in mind, we will be using the Unet architecture as the starting architecture for this segmentation task.</p><h2 id="framing-of-the-problem">Framing of the Problem</h2><p>Before we get into the solution, letâ€™s take a step back and look at the problem we are trying to solve in the context of deep learning. As we saw last week, we are given a 3D tensor of shape (12, 64, 64) as input, and we are trying to predict a 2D tensor of shape (64, 64) as output, which is our next day fire mask. We can think of this as a segmentation problem, where the task is classification of each output pixel as either 0 or 1, where 0 means no fire and 1 means fire. So how do we know how good the prediction is? Two common metrics for segmentation tasks are the <a href="https://en.wikipedia.org/wiki/S%C3%B8rensen%E2%80%93Dice_coefficient">Dice coefficient</a> and the <a href="https://en.wikipedia.org/wiki/Jaccard_index">Jaccard index</a>.</p><p>Given two sets X and Y, Dice coefficient is defined as:</p><p><img src="/images/dice_coefficient.png" alt="dice_coefficient" /></p><p>Whereas similarly, the Jaccard index is defined as:</p><p><img src="/images/jaccard_index.png" alt="jaccard_index" /></p><p>In the context of our fire spread prediction, we can think of the ground truth fire mask as a set of pixels A and the predicted fire mask as a set of pixels B. Then, the Dice coefficient and Jaccard index can be used to evaluate the accuracy of the prediction. The higher the value, the better the prediction.</p><h2 id="unet">Unet</h2><p>Unet is a simple yet powerful architecture originally developed for biomedical imaging segmentation tasks. It is composed of an encoder and a decoder, where the encoder is a series of convolutional layers that downsample the input, and the decoder is a series of convolutional layers that upsample the input. The encoder and decoder are connected by skip connections, which allow the decoder to use information from the encoder to improve the segmentation results. The architecture is shown below:</p><p><img src="/images/u-net-architecture.png" alt="unet_image" /></p><p>Using this network allows us to get some initial results relatively fast to get a handle on the problem of predicting wildfire spread, and if the results are promising, we can then explore more sophisticated architectures.</p><h2 id="baseline-results">Baseline Results</h2><p>Due to the large size of the dataset and limited GPU resources, we downsampled the dataset from 64x64 to 32x32 and only used the 3 most important dimensions discovered in the original dataset paper: previous day fire mask, vegetation, and elevation. For the loss function, we used binary cross entropy with a positive weight of 100 to account for the imbalance between fire and no fire pixels, and for the optimizer, we used the default Unet scheduler with a learning rate of 1e-5.</p><p>The model was trained on an A800-80G GPU for 10 epochs, and we obtained the following results:</p><p><img src="/images/train_loss_unet.png" alt="train_loss_unet" /> <img src="/images/validation_unet.png" alt="validation_unet" /></p><p>As shown here in the results, we can see that unfortunately the dice score is plateauing at around 0.18, which is not very good. There are a few possible explanations, including the fact that the model is too simple, or the problem is not framed correctly. We will explore these possibilities in the next few weeks.</p><h2 id="next-steps">Next Steps</h2><p>Next week, we will be exploring the possibility of:</p><ol><li>Preprocessing in different ways the input and target labels to improve the results, for example, by using a different representation of the target labels including using the change in fire rather than fire/no fire. Another idea is to only predict the surrounding the current fire perimeter rather than the entire image, mentioned in the <a href="https://www.ijcai.org/proceedings/2019/636">FireCast paper</a>.</li><li>Applying a different loss function that may better reflect the nature of the problem by reviewing and trying out implementations <a href="https://github.com/shruti-jadon/Semantic-Segmentation-Loss-Functions">here</a>.</li></ol><p>Photo by <a href="https://unsplash.com/@urielsc26">Uriel SC</a> on <a href="https://unsplash.com">Unsplash</a></p></p></div><div class="disqus-comments" id="disqus_thread"></div></div></div></section><footer id="footer"> <!--Footer Button--><div class="container has-text-centered has-background-grey-darker" id="backtotop"> <a class="has-text-white" onclick="window.scroll(0,0)">BACK TO TOP</a></div><!--Footer Main Section--><div class="has-background-grey-darker"><div class="container columns"> <!--Name Section--><div class="column has-text-left-desktop has-text-centered-mobile"> <a href="http://localhost:4000/#about"><div class="columns"><div class="column is-one-fifth-desktop is-one-fifth-fullhd is-one-quarter-tablet"><figure class="image is-64x64"> <img class="is-rounded" src="https://bronteee.github.io/images/headshot.JPG"></figure></div><div class="column is-marginless"><h5 class="has-text-grey-lighter">Bronte Sihan Li</h5><div class="content has-text-grey"><p>Bronte found her passion in artificial intelligence and research while w...</p></div></div></div></a></div><!--Link Section--><div class="column has-text-white"><h3>More Links</h3><li> <a href="http://localhost:4000/introduction/">Introduction</a></li><li> <a href="http://localhost:4000/wildfire-data/">Wildfire Data</a></li><li> <a href="http://localhost:4000/wildfire-spread/">Wildfire Spread Modeling</a></li></div><!--Blog-post Section--><div class="column has-text-white"><h3>Recent Posts</h3><li> <a href="http://localhost:4000/week8/">Week 8 | Exploring Different Deep Network Architectures</a></li><li> <a href="http://localhost:4000/week7/">Week 7 | What We Have Found So Far</a></li><li> <a href="http://localhost:4000/week6/">Week 6 | Exploring Different Ways to Improve</a></li></div></div></div><div class="has-background-black has-text-centered has-text-white" id="credits"> <i class="far fa-copyright"></i> 2024 | <a href="https://github.com/thedevslot/WhatATheme" target="_blank" rel="noopener noreferrer">WhatATheme</a> - A Theme made with <i class="fas fa-heart has-text-danger"></i> by <a href="https://www.twitter.com/thedevslot" target="_blank" rel="noopener noreferrer">TheDevsLot</a> Powered by <a href="https://jekyllrb.com/" target="_blank">Jekyll</a></div></footer></body><script> /** * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS. * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/ /* var disqus_config = function () { this.page.url = PAGE_URL; Replace PAGE_URL with your page's canonical URL variable this.page.identifier = PAGE_IDENTIFIER; Replace PAGE_IDENTIFIER with your page's unique identifier variable }; */ (function () { /* DON'T EDIT BELOW THIS LINE */ var d = document, s = d.createElement('script'); s.src = 'https://.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script></html>
